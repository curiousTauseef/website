<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Conway's Game of Life in Ruby (bjorkoy.com)</title>
  <meta name="author" content="Olav Bjorkoy">
  <meta name="description" content="Conway's Game of Life in Ruby - Olav Bjorkoy's blog on CSS, Blueprint, HTML, Ruby and anything in-between.">
  <meta name="keywords" content="HTML, CSS, JS, Blueprint, Ruby, Rails, Olav Bjorkoy, Olav">
  
  <!-- <link href="/atom.xml" rel="alternate" title="bjorkoy.com" type="application/atom+xml"> -->
  <link href="http://feeds.feedburner.com/bjorkoy" rel="alternate" title="bjorkoy.com" type="application/atom+xml">
  <meta name="google-site-verification" content="7vDyCyvSym2pZLSBnjl1IrtN-hp00gqMfNG8fbHNXyM">
  
  <link rel="icon" type="image/png" href="http://bjorkoy.com/images/icon.png?8">
  
  <script type="text/javascript" src="/js/hyphenate.js"></script>
  <script type="text/javascript" src="/js/width.js"></script>
  <script type="text/javascript" src="http://use.typekit.com/zmq0szj.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script type="text/javascript">
    window.addEventListener('load', function () {
      var postBody = document.getElementsByClassName('post')[0];
      setTextMeasure(postBody);
    }, false);
  </script>
  
  <link rel="stylesheet" href="/css/reset.css" type="text/css">
  <link rel="stylesheet" href="/css/syntax.css" type="text/css">
  <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection">
  <script src="/mentos/?js" type="text/javascript"></script>
</head>
<body id="bjorkoy-com">
<div id="container" class="hyphenate">

<ul id="menu">
  <li><a href="http://bjorkoy.com">bjorkoy.com</a></li>
  <li class="orn">★</li>
  <li><a href="/archive.html">articles</a></li>
  <li class="orn">★</li>
  <li><a href="http://github.com/olav">projects</a></li>
  <!--<li class="orn">★</li>-->
  <!--<li><a href="http://twitter.com/vandelay">twitter</a></li>-->
  <li class="orn">★</li>
  <li><a href="/about.html">about</a></li>
</ul>

  
  


<div class="post">
  <h2><span>Conway's Game of Life in Ruby</span></h2>
  <div class="content">
    <div class='highlight'><pre><code class='ruby'><span class='c1'>#</span>
<span class='c1'># Conway&#39;s Game of Life in Ruby</span>
<span class='c1'># http://en.wikipedia.org/wiki/Conway&#39;s_Game_of_Life</span>
<span class='c1'># </span>
<span class='c1'># Some code from this excellent article:</span>
<span class='c1'># http://rubyquiz.strd6.com/quizzes/193-game-of-life</span>
<span class='c1'>#</span>

<span class='k'>class</span> <span class='nc'>Cell</span>
  <span class='kp'>attr_writer</span> <span class='ss'>:neighbors</span>
  
  <span class='k'>def</span> <span class='nf'>initialize</span><span class='p'>(</span><span class='n'>seed_probability</span><span class='p'>)</span>
    <span class='vi'>@alive</span> <span class='o'>=</span> <span class='n'>seed_probability</span> <span class='o'>&gt;</span> <span class='nb'>rand</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>next!</span>
    <span class='vi'>@alive</span> <span class='o'>=</span> <span class='vi'>@alive</span> <span class='p'>?</span> <span class='p'>(</span><span class='mi'>2</span><span class='o'>.</span><span class='n'>.</span><span class='mi'>3</span><span class='p'>)</span> <span class='o'>===</span> <span class='vi'>@neighbors</span> <span class='p'>:</span> <span class='mi'>3</span> <span class='o'>==</span> <span class='vi'>@neighbors</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>to_i</span>
    <span class='vi'>@alive</span> <span class='p'>?</span> <span class='mi'>1</span> <span class='p'>:</span> <span class='mi'>0</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>to_s</span>
    <span class='vi'>@alive</span> <span class='p'>?</span> <span class='s1'>&#39;o&#39;</span> <span class='p'>:</span> <span class='s1'>&#39; &#39;</span>
  <span class='k'>end</span>
<span class='k'>end</span>

<span class='k'>class</span> <span class='nc'>Game</span>
  
  <span class='k'>def</span> <span class='nf'>initialize</span><span class='p'>(</span><span class='n'>width</span><span class='p'>,</span> <span class='n'>height</span><span class='p'>,</span> <span class='n'>seed_probability</span><span class='p'>,</span> <span class='n'>steps</span><span class='p'>)</span>
    <span class='vi'>@width</span><span class='p'>,</span> <span class='vi'>@height</span><span class='p'>,</span> <span class='vi'>@steps</span> <span class='o'>=</span> <span class='n'>width</span><span class='p'>,</span> <span class='n'>height</span><span class='p'>,</span> <span class='n'>steps</span>
    <span class='vi'>@cells</span> <span class='o'>=</span> <span class='nb'>Array</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='n'>height</span><span class='p'>)</span> <span class='p'>{</span> 
      <span class='nb'>Array</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='n'>width</span><span class='p'>)</span> <span class='p'>{</span> <span class='no'>Cell</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='n'>seed_probability</span><span class='p'>)</span> <span class='p'>}</span> <span class='p'>}</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>play!</span>
    <span class='p'>(</span><span class='mi'>1</span><span class='o'>.</span><span class='n'>.</span><span class='vi'>@steps</span><span class='p'>)</span><span class='o'>.</span><span class='n'>each</span> <span class='k'>do</span>
      <span class='k'>next</span><span class='o'>!</span>
      <span class='nb'>system</span><span class='p'>(</span><span class='s1'>&#39;clear&#39;</span><span class='p'>)</span>
      <span class='nb'>puts</span> <span class='nb'>self</span>
    <span class='k'>end</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>next!</span>
    <span class='vi'>@cells</span><span class='o'>.</span><span class='n'>each_with_index</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>row</span><span class='p'>,</span> <span class='n'>y</span><span class='o'>|</span>
      <span class='n'>row</span><span class='o'>.</span><span class='n'>each_with_index</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>cell</span><span class='p'>,</span> <span class='n'>x</span><span class='o'>|</span>
        <span class='n'>cell</span><span class='o'>.</span><span class='n'>neighbors</span> <span class='o'>=</span> <span class='n'>alive_neighbours</span><span class='p'>(</span><span class='n'>y</span><span class='p'>,</span> <span class='n'>x</span><span class='p'>)</span>
      <span class='k'>end</span>
    <span class='k'>end</span>
    <span class='vi'>@cells</span><span class='o'>.</span><span class='n'>each</span> <span class='p'>{</span> <span class='o'>|</span><span class='n'>row</span><span class='o'>|</span> <span class='n'>row</span><span class='o'>.</span><span class='n'>each</span> <span class='p'>{</span> <span class='o'>|</span><span class='n'>cell</span><span class='o'>|</span> <span class='n'>cell</span><span class='o'>.</span><span class='n'>next!</span> <span class='p'>}</span> <span class='p'>}</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>alive_neighbours</span><span class='p'>(</span><span class='n'>y</span><span class='p'>,</span> <span class='n'>x</span><span class='p'>)</span>
    <span class='o'>[[-</span><span class='mi'>1</span><span class='p'>,</span> <span class='mi'>0</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='mi'>1</span><span class='p'>,</span> <span class='mi'>0</span><span class='o'>]</span><span class='p'>,</span> <span class='c1'># sides</span>
     <span class='o'>[-</span><span class='mi'>1</span><span class='p'>,</span> <span class='mi'>1</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='mi'>0</span><span class='p'>,</span> <span class='mi'>1</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='mi'>1</span><span class='p'>,</span> <span class='mi'>1</span><span class='o'>]</span><span class='p'>,</span> <span class='c1'># over</span>
     <span class='o'>[-</span><span class='mi'>1</span><span class='p'>,</span> <span class='o'>-</span><span class='mi'>1</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='mi'>0</span><span class='p'>,</span> <span class='o'>-</span><span class='mi'>1</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='mi'>1</span><span class='p'>,</span> <span class='o'>-</span><span class='mi'>1</span><span class='o'>]</span> <span class='c1'># under</span>
    <span class='o'>].</span><span class='n'>inject</span><span class='p'>(</span><span class='mi'>0</span><span class='p'>)</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>sum</span><span class='p'>,</span> <span class='n'>pos</span><span class='o'>|</span>
      <span class='n'>sum</span> <span class='o'>+</span> <span class='vi'>@cells</span><span class='o'>[</span><span class='p'>(</span><span class='n'>y</span> <span class='o'>+</span> <span class='n'>pos</span><span class='o'>[</span><span class='mi'>0</span><span class='o'>]</span><span class='p'>)</span> <span class='o'>%</span> <span class='vi'>@height</span><span class='o'>][</span><span class='p'>(</span><span class='n'>x</span> <span class='o'>+</span> <span class='n'>pos</span><span class='o'>[</span><span class='mi'>1</span><span class='o'>]</span><span class='p'>)</span> <span class='o'>%</span> <span class='vi'>@width</span><span class='o'>].</span><span class='n'>to_i</span>
    <span class='k'>end</span>
  <span class='k'>end</span>
  
  <span class='k'>def</span> <span class='nf'>to_s</span>
    <span class='vi'>@cells</span><span class='o'>.</span><span class='n'>map</span> <span class='p'>{</span> <span class='o'>|</span><span class='n'>row</span><span class='o'>|</span> <span class='n'>row</span><span class='o'>.</span><span class='n'>join</span> <span class='p'>}</span><span class='o'>.</span><span class='n'>join</span><span class='p'>(</span><span class='s2'>&quot;</span><span class='se'>\n</span><span class='s2'>&quot;</span><span class='p'>)</span>
  <span class='k'>end</span>
<span class='k'>end</span>

<span class='no'>Game</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='mi'>100</span><span class='p'>,</span> <span class='mi'>50</span><span class='p'>,</span> <span class='mi'>0</span><span class='o'>.</span><span class='mi'>1</span><span class='p'>,</span> <span class='mi'>100</span><span class='p'>)</span><span class='o'>.</span><span class='n'>play!</span>
</code></pre>
</div>
  </div>
  <p class="date">~ 14 May 2010</p>
</div>    

</div>
</body>
</html>
